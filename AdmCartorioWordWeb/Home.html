<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>Word Add-In with Commands Sample</title>

    <script src="Scripts/jquery-1.9.1.js" type="text/javascript"></script>
    <script src="Scripts/FabricUI/MessageBanner.js" type="text/javascript"></script>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>

    <!-- Para habilitar depuração offline usando referência local para Office.js, use:                        -->
    <!-- <script src="Scripts/Office/MicrosoftAjax.js" type="text/javascript"></script>  -->
    <!-- <script src="Scripts/Office/1/office.js" type="text/javascript"></script>  -->

    <link href="Home.css" rel="stylesheet" type="text/css" />
    <script src="Home.js" type="text/javascript"></script>

    <!-- Para o Office UI Fabric, vá para https://aka.ms/office-ui-fabric para saber mais. -->
    <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.min.css">
    <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/2.1.0/fabric.components.min.css">

    <!-- Para habilitar o uso do Office UI Fabric offline, use: -->
    <!-- link rel="stylesheet" href="Content/fabric.min.css" -->
    <!-- link rel="stylesheet" href="Content/fabric.components.min.css" -->
    
    <!-- ANGULAR JS-->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>



    <script type="text/javascript">
        
        /**** ANGULAR JS */
        var module = angular.module("criaModelo", []);

        module.controller('criaModeloController', ['$scope', '$http', function ($scope, $http) {
            $scope.valorCampo = "";

            $scope.testeGet = [];
            $scope.respostaTeste;

            $http({
                method: 'GET',
                url: 'http://localhost:65395/api/camposarquivomodelo'
            }).then(function successCallback(response) {
                $scope.testeGet = response.data;
                $scope.respostaTeste = 1;
            }, function errorCallback(response) {
                $scope.respostaTeste = 2;
            });


            $scope.data = {
                "NaturezaCampo": [
                    {
                        "Natureza": "Imoveis",
                        "Campos":
                            [
                                "Pune",
                                "Mumbai",
                                "Nagpur"
                            ]
                    },
                    {
                        "Natureza":
                            "Civil",
                        "Campos":
                            [
                                "Surat",
                                "Ahmedabad",
                                "Baroda"
                            ]
                    },
                    {
                        "Natureza":
                            "Eletricidade",
                        "Campos":
                            ["Jaipur"
                                , "Ajmer"
                                , "Jodhpur"
                            ]
                    }
                ]
            }


            $scope.OnChangeNatureza = function () {

            };


            $scope.criarElementoDeControle = function (valorCampo) {
                Word.run(function (context) {

                    var serviceNameRange = context.document.getSelection();
                    var serviceNameContentControl = serviceNameRange.insertContentControl();
                    serviceNameContentControl.title = valorCampo;
                    serviceNameContentControl.tag = valorCampo;
                    serviceNameContentControl.appearance = "Tags";
                    serviceNameContentControl.color = "gray";
                    serviceNameContentControl.placeholderText = valorCampo;

                    return context.sync();
                })
                    .catch(function (error) {
                        console.log("Error: " + error);
                        if (error instanceof OfficeExtension.Error) {
                            console.log("Debug info: " + JSON.stringify(error.debugInfo));
                        }
                    });
            }


        }]);
    </script>

    <!-- FIM ANGULAR JS-->
</head>
<body>
    <div id="content-header">
        <div class="padding">
            <h1 class="ms-fontWeight-semibold">Gerenciar campos</h1>
            <hr />
        </div>
    </div>
    <div id="content-main">
        <div class="padding" ng-app="criaModelo" ng-controller="criaModeloController">

            <div class="padding">
                <label class="ms-fontSize-xl">
                    Selecione a natureza
                </label>
                <br />
                <div class="">
                    <select class=""
                            id="natureza"
                            ng-change="OnChangeNatureza()"
                            ng-model="natureza"
                            ng-disabled="campo"
                            ng-options="natureza.Natureza for natureza in data.NaturezaCampo">
                        <option value="" class="ms-Dropdown">Selecione</option>
                    </select>
                </div>

                <br />

                <label class="ms-fontSize-xl">
                    Selecione o campo
                </label>
                <br />
                <div class="">
                    <select class=""
                            ng-disabled="!natureza"
                            ng-model="campo"
                            ng-options="campo for campo in natureza.Campos"
                            id="campo">
                        <option value="">
                            Selecione
                        </option>
                    </select>
                </div>
            </div>
            <div class="padding">
                <button class="ms-Button ms-Button--primary" id="create-content-control"
                        ng-click="criarElementoDeControle(campo)"
                        ng-disabled="!natureza || !campo">
                    <label class="ms-fontColor-white">Adicionar campo</label>
                </button>
            </div>
            <label>{{testeGet}}</label>
            <label>{{respostaTeste}}</label>
        </div>
    </div>
    <br />
    <!--<div id="supportedVersion" />-->
</body>
</html>
