@model Cartorio11RI.ViewModels.AtoViewModel

@{
    ViewBag.Title = "Atos";
    ViewBag.SubTitle = "Novo ato";
}

@section styles_especific {
    <style>
        #tbl-pessoas-selecionadas {
            /*border: 1px solid #808080; */
            table-layout: auto;
            width: 100%;
        }

        #tbl-selecao-pessoas {
            /*border: 1px solid #808080; */
            table-layout: auto;
            width: 100%;
        }

        /*-- tbl-pessoas-selecionadas ----------------------------------------*/
        #tbl-pessoas-selecionadas tr td:nth-child(1) {
            width: 3%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(2) {
            width: 15%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(3) {
            width: 15%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(4) {
            width: 3%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(5) {
            width: 3%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(6) {
            width: 10%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(7) {
            width: 10%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(8) {
            width: 3%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(9) {
            width: 4%;
        }

        #tbl-pessoas-selecionadas tr td:nth-child(10) {
            width: 5%;
        }

        /*-- tbl-selecao-pessoas ---------------------------------------------*/
        #tbl-selecao-pessoas tr td:nth-child(1) {
            width: 3%;
        }

        #tbl-selecao-pessoas tr td:nth-child(2) {
            width: 10%;
        }

        #tbl-selecao-pessoas tr td:nth-child(3) {
            width: 20%;
        }

        #tbl-selecao-pessoas tr td:nth-child(4) {
            width: 67%;
        }

        .checkbox-selecao-pessoas {
            visibility: visible;
        }

        .div-container-scroll {
            width: 580px;
            height: 480px;
            overflow-y: auto;
            overflow-x: auto;
        }
    </style>
}

<div id="content">
    <div class="row">
        <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
            <h1 class="page-title txt-color-blueDark">
                <i class="fa fa-pencil-square-o fa-fw "></i>
                @ViewBag.Title
                <span>
                    >
                    @ViewBag.SubTitle
                </span>
            </h1>
        </div>
    </div>

    <!-- widget grid -->
    <section id="widget-grid" class="">

        <div class="row">
            <article class="col-sm-12 col-md-12 col-lg-12">
                <!-- Widget ID (each widget will need unique ID)-->
                <div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-deletebutton="false" data-widget-collapsed="false">

                    <header>
                        <span class="widget-icon"> <i class="fa fa-user"></i> </span>
                        <h2>Novo ato</h2>
                    </header>

                    <!-- widget div-->
                    <div>

                        <!-- widget edit box -->
                        <div class="jarviswidget-editbox">
                            <!-- This area used as dropdown edit box -->
                        </div>
                        <!-- end widget edit box -->
                        <!-- div wizard ato -------------------------------- -->
                        @Html.Partial("_divWizardAto", Model)
                    </div>
                </div>
            </article>
        </div>
    </section>
</div>

<!-- dálogo div-dlg-pessoas ------------------------------------------------ -->
<div class="modal fade" id="div-dlg-pessoas" role="dialog" aria-hidden="true">
    <div class="modal-dialog  modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    ×
                </button>
                <h4 class="modal-title"><label id="lbl-dlg-pessoa-header"></label></h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <table class="table table-striped" id="tbl-selecao-pessoas">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Tipo</th>
                                <th>DOC</th>
                                <th>Nome</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr></tr>
                            <!-- APPEND JSON-->
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btn-dlg-pessoas-cancela" class="btn btn-danger" data-dismiss="modal">
                    <i class="glyphicon glyphicon-remove"></i>&nbsp;Cancela
                </button>
                <button type="button" id="btn-dlg-pessoas-ok" class="btn btn-success">
                    <i class="glyphicon glyphicon-ok"></i>&nbsp;Ok
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>

@section pagespecific{

    <script src="~/Scripts/cartoonsoft/cartoonsoft_libs.js"></script>
    <script src="~/scripts/plugin/bootstrap-wizard/jquery.bootstrap.wizard.min.js"></script>
    <script src="~/scripts/plugin/fuelux/wizard/wizard.min.js"></script>
    <script src="~/Scripts/cartoonsoft/Atos/novo_ato.js"></script>
    <script src="~/Scripts/plugin/ckeditor/ckeditor.js"></script>
    <script src="~/Scripts/plugin/ckeditor/adapters/jquery.js"></script>

    <script>
        $(document).ready(function () {

            /* urls chamadas ajax --------------------------------------------*/
            var urlGetDadosImovel = '@Url.Action("GetDadosImovel", "Atos")';
            var urlGetPessoasPrenotacao = '@Url.Action("GetPessoasPrenotacao", "Atos")';
            var urlGetListaModelosDocx = '@Url.Action("GetListaModelosDocx", "Atos")';

            //obter ip local ------------------------------------------------- /
            var ipLocal = getUserIP(function (ip) {
                var t = navigator.product;
                $("#IpLocal").val(ip);
            });

            $('.tree > ul').attr('role', 'tree').find('ul').attr('role', 'group');
            $('.tree').find('li:has(ul)').addClass('parent_li').attr('role', 'treeitem').find(' > span').on('click', function (e) {
                var children = $(this).parent('li.parent_li').find(' > ul > li');
                if (children.is(':visible')) {
                    children.hide('slow');
                    $(this).find(' > i').removeClass().addClass('fa fa-lg fa-plus-circle');
                } else {
                    children.show('slow');
                    $(this).find(' > i').removeClass().addClass('fa fa-lg fa-minus-circle');
                }
                e.stopPropagation();
            });


            var vetIdPessoasSel = [];
            var id = $("#Id").val();
            DesabilitarProximo();
            
            //validate ------------------------------------------------------- /
            var $frmNovoModelo = $("#frmNovoModelo").validate({
                // Rules for form validation
                rules: {
                    DescricaoTipoAto: {
                        required: true
                    },
                    DescricaoAto: {
                        required: true
                    }
                },
                // Messages for form validation
                messages: {
                    DescricaoTipoAto: {
                        required: "Selecione tipo de ato"
                    },
                    DescricaoAto: {
                        required: "Digite um descrição para oa ato"
                    }
                },
                // Do not change code below
                errorPlacement: function (error, element) {
                    error.insertAfter(element.parent());
                }
            });

            $(".somente-numero-sem-decimal").on("keypress keyup blur", function (event) {
                $(this).val($(this).val().replace(/[^\d].+/, ""));
                if ((event.which < 48 || event.which > 57)) {
                    event.preventDefault();
                }
            });

            /*-- pesqusar por prenotacao ------------------------------------ */
            $("#PREIMO_SEQPRE").keydown(function (e) {
                if (e.keyCode == 13) {
                    $("#btn-pesq-prenotacao").click();
                }
            });

            $("#btn-pesq-prenotacao").click(function (e) {
                e.preventDefault();
                var premaMat = $("#PREIMO_SEQPRE").val();
                PesquisarPrenotacaoMatricula(premaMat, urlGetDadosImovel);
            });

            /*-- pesquisar pessoas ------------------------------------------ */
            $("#btn-pesq-pessoas").click(function (e) {
                e.preventDefault();

                var dadosPrenotacao = {
                    numeroPrenotacao: $("#PREIMO_SEQPRE").val()
                };

                GetPessoasPrenotacao(dadosPrenotacao, urlGetPessoasPrenotacao);
            });

            /*-- btn-dlg-pessoas-ok   --------------------------------------- */
            $("#btn-dlg-pessoas-ok").click(function (e) {
                e.preventDefault();
                PovoarSelecionados($('#PREIMO_SEQPRE').val());
            });

            /*-- fuelux wizard ---------------------------------------------- */
            var wizard = $('#divWizardEtapas').wizard();

            wizard.on('finished', function (e, data) {
                //$("#fuelux-wizard").submit();
                //console.log("submitted!");
                $.smallBox({
                    title: "Congratulations! Your form was submitted",
                    content: "<i class='fa fa-clock-o'></i> <i>1 seconds ago...</i>",
                    color: "#5F895F",
                    icon: "fa fa-thumbs-up bounce animated",
                    timeout: 4000
                });
            });

            /*-- ckeditor --------------------------------------------------- */
            CKEDITOR.replace('ckEditorPreviewModelo', {
                width: '100%',
                height: '240px',
                startupFocus: true,
                toolbarGroups: [
		            { name: 'document', groups: [ 'mode', 'document', 'doctools' ] },
		            { name: 'clipboard', groups: [ 'clipboard', 'undo' ] },
		            { name: 'editing', groups: [ 'find', 'selection', 'spellchecker', 'editing' ] },
		            { name: 'forms', groups: [ 'forms' ] },
		            { name: 'basicstyles', groups: [ 'basicstyles', 'cleanup' ] },
		            { name: 'paragraph', groups: [ 'list', 'indent', 'blocks', 'align', 'bidi', 'paragraph' ] },
		            { name: 'links', groups: [ 'links' ] },
		            { name: 'insert', groups: [ 'insert' ] },
		            { name: 'styles', groups: [ 'styles' ] },
		            { name: 'colors', groups: [ 'colors' ] },
		            { name: 'tools', groups: [ 'tools' ] },
		            { name: 'others', groups: [ 'others' ] },
		            { name: 'about', groups: [ 'about' ] }
                ],
                removeButtons: 'Source,Save,Templates,Cut,Undo,Find,SelectAll,Scayt,Form,NewPage,Copy,Paste,PasteText,PasteFromWord,Redo,Replace,Radio,TextField,Select,ImageButton,HiddenField,Subscript,Superscript,RemoveFormat,NumberedList,BulletedList,Outdent,Indent,Blockquote,CreateDiv,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,BidiLtr,Link,Anchor,Language,Image,Flash,Unlink,Table,HorizontalRule,Smiley,SpecialChar,PageBreak,Iframe,TextColor,BGColor,About,Button,Checkbox,Textarea,ShowBlocks'
            });



        });

        /**
         * /
         * @@param btnObj
         * @@param idTipoAto
         */
        function SelecionarTipoAto(btnObj, idTipoAto)
        {
            var btn = btnObj;
            var idTmp = idTipoAto;
            if (typeof btn !== 'undefined' || btn !== null) {
                var txtTipoAto = btn.innerText.trim();
                $("#IdTipoAto").val(idTipoAto);
                $("#DescricaoTipoAto").val(txtTipoAto);

                $(".btn-tree-tipo-ato").removeClass("btn-danger");
                $(btn).addClass("btn-danger");
                var sel = $("#selModelosDocx");

                PovoarSelModelos(idTmp, sel, urlGetListaModelosDocx);

            }
        }

    </script>
}
